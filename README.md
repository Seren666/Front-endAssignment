# CollaBoard
<div align="center">

**å¤šäººå®æ—¶åä½œç™½æ¿**

</div>

æ”¯æŒè‡ªç”±ç»˜åˆ¶ã€å›¾å½¢ç»˜åˆ¶ã€æ’¤é”€/é‡åšã€å¤šäººå…‰æ ‡å’Œå¯¼å‡ºå›¾ç‰‡ç­‰åŠŸèƒ½ã€‚

ã€åœ¨è¿™é‡Œæ”¾demoè§†é¢‘ã€‘

## ç›®å½•
- [CollaBoard](#Collaboard)
  - [ç›®å½•](#ç›®å½•)
  - [ç¤ºä¾‹](#ç¤ºä¾‹)
  - [ä¸»è¦åŠŸèƒ½](#ä¸»è¦åŠŸèƒ½)
  - [æ ¸å¿ƒåŸç†](#æ ¸å¿ƒåŸç†)
    - [æ¦‚è¿°](#æ¦‚è¿°)
    - [åè®®ä¸äº‹ä»¶å®šä¹‰](#åè®®ä¸äº‹ä»¶å®šä¹‰)
    - [å¼€å‘æç¤º](#å¼€å‘æç¤º)
  - [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
    - [å®‰è£…ä¾èµ–](#å®‰è£…ä¾èµ–)
    - [å¯åŠ¨å¼€å‘ç¯å¢ƒ](#å¯åŠ¨å¼€å‘ç¯å¢ƒ)
  - [é¡¹ç›®ç›®å½•è¯´æ˜](#é¡¹ç›®ç›®å½•è¯´æ˜)
  



## ç¤ºä¾‹
ä»¥ä¸‹æ˜¯CollaBoardçš„ä½¿ç”¨æ¼”ç¤º
ã€åœ¨è¿™é‡Œæ”¾ä½¿ç”¨æ¼”ç¤ºæˆªå›¾æˆ–jpgã€‘


## ä¸»è¦åŠŸèƒ½

- ğŸ– **è‡ªç”±ç»˜åˆ¶**ï¼šæ”¯æŒå¤šç§ç”»ç¬”ï¼ˆé“…ç¬”ã€é©¬å…‹ç¬”ã€æ¿€å…‰ç¬”ã€æ©¡çš®æ“¦ï¼‰
- ğŸ”· **å›¾å½¢ç»˜åˆ¶**ï¼šçŸ©å½¢ã€åœ†å½¢ã€ä¸‰è§’å½¢ã€å¤šè¾¹å½¢ã€ç®­å¤´ç­‰å‡ ä½•å›¾å½¢
- ğŸ”„ **æ’¤é”€ / é‡åš**ï¼šåŸºäºè½¯åˆ é™¤å’Œ per-user undo æ ˆ
- ğŸ‘¥ **å®æ—¶åä½œ**ï¼šå¤šäººåŒæ—¶åœ¨çº¿ç»˜åˆ¶ä¸å…‰æ ‡åŒæ­¥
- ğŸ  **åˆ›å»ºæˆ¿é—´å¹¶åŠ å…¥**ï¼šæ”¯æŒé€šè¿‡æˆ¿é—´å·å’Œå¯†ç åˆ›å»ºå’ŒåŠ å…¥ç‰¹å®šæˆ¿é—´
- ğŸ“¸ **å¯¼å‡º PNG**ï¼šå°†ä¸»ç”»å¸ƒå†…å®¹å¯¼å‡ºä¸ºå›¾ç‰‡
- âš™ï¸ **é«˜æ¸…ç”»å¸ƒæ¸²æŸ“**ï¼šæ”¯æŒé«˜ DPI è®¾å¤‡ä¼˜åŒ– canvas æ˜¾ç¤º

---

## æ ¸å¿ƒåŸç†

### æ¦‚è¿°
æ•´ä¸ªç³»ç»Ÿé‡‡ç”¨ **Clientâ€“Server + WebSocket** æ¨¡å¼ï¼š

æµè§ˆå™¨ Client âŸ· Socket.io âŸ· Node æœåŠ¡ç«¯
React + Canvas â†â†’ Express + Socket.io

å‰ç«¯è´Ÿè´£è·å–ç”¨æˆ·è¾“å…¥ï¼Œåœ¨æœ¬åœ°æ¸²æŸ“é¢„è§ˆå¹¶æ„é€ ç»˜åˆ¶åŠ¨ä½œï¼ˆDrawActionï¼‰ï¼Œåœ¨ pointerup æ—¶å‘é€ç»™åç«¯ã€‚  
åç«¯ç»´æŠ¤æˆ¿é—´çŠ¶æ€ï¼Œå¹¶å¹¿æ’­ç»™æˆ¿é—´å†…æ‰€æœ‰å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯æ ¹æ®æ”¶åˆ°çš„åŠ¨ä½œæ›´æ–°æœ¬åœ°çŠ¶æ€å¹¶é‡ç»˜ç”»å¸ƒï¼Œä»è€Œä¿è¯æ¯ä¸ªäººçœ‹åˆ°çš„å†…å®¹ä¸€è‡´ã€‚

### åè®®ä¸äº‹ä»¶å®šä¹‰ï¼ˆSocketï¼‰

#### ğŸ“¨ å®¢æˆ·ç«¯ â†’ æœåŠ¡ç«¯

| äº‹ä»¶å             | Payload                        | è¯´æ˜     |
| --------------- | ------------------------------ | ------ |
| `room:join`     | `{ roomId, userName }`         | åŠ å…¥æˆ¿é—´   |
| `draw:commit`   | `{ roomId, action }`           | æäº¤ç»˜åˆ¶åŠ¨ä½œ |
| `action:undo`   | `{ roomId, userId }`           | æ’¤é”€æ“ä½œ   |
| `action:redo`   | `{ roomId, userId }`           | é‡åšæ“ä½œ   |
| `cursor:update` | `{ roomId, position, pageId }` | å…‰æ ‡æ›´æ–°   |
| `board:clear`   | `{ roomId, pageId }`           | æ¸…ç©ºç”»å¸ƒ   |

#### ğŸ“¤ æœåŠ¡ç«¯ â†’ å®¢æˆ·ç«¯

| äº‹ä»¶å                     | Payload                                | è¯´æ˜      |
| ----------------------- | -------------------------------------- | ------- |
| `room:joined`           | `{ roomId, self, state }`              | åŠ å…¥æˆåŠŸ    |
| `draw:created`          | `{ roomId, action }`                   | å¹¿æ’­æ–°åŠ¨ä½œ   |
| `action:updatedDeleted` | `{ roomId, actionId, isDeleted }`      | æ’¤é”€/æ¢å¤æ›´æ–° |
| `cursor:updated`        | `{ roomId, userId, position, pageId }` | å…‰æ ‡æ›´æ–°    |
| `board:cleared`         | `{ roomId, pageId }`                   | æ¸…å±å¹¿æ’­    |
| `room:state-sync`       | `{ roomId, state }`                    | å…¨é‡åŒæ­¥    |
### å¼€å‘æç¤º

* æ‰€æœ‰åŠ¨ä½œä½¿ç”¨ **å½’ä¸€åŒ–åæ ‡ï¼ˆ0~1ï¼‰**ï¼Œä¸åŒå±å¹•å°ºå¯¸ä¿æŒä¸€è‡´
* æ’¤é”€ç”¨è½¯åˆ é™¤ï¼ˆ`isDeleted`ï¼‰ï¼Œå‡å°‘å†²çª
* å…‰æ ‡æ›´æ–°å»ºè®® **èŠ‚æµ 50ms**
* canvas åœ¨é«˜ DPI å±å¹•ä¸‹éœ€è¦å¤„ç† `devicePixelRatio` å¹¶ç”¨ `ctx.scale(dpr, dpr)` é¿å…æ¨¡ç³Š

## å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

åœ¨æ ¹ç›®å½•è¿è¡Œï¼š

```bash
npm run install:all
````

æˆ–æ‰‹åŠ¨å®‰è£…ï¼š

```bash
cd client
npm install

cd ../server
npm install
```

---

### å¯åŠ¨å¼€å‘ç¯å¢ƒ

**å‰ç«¯ï¼ˆClientï¼‰ï¼š**

```bash
cd client
npm run dev
```

é»˜è®¤ï¼š[http://localhost:5173](http://localhost:5173)

**åç«¯ï¼ˆServerï¼‰ï¼š**

```bash
cd server
npm run dev
```

é»˜è®¤ï¼š[http://localhost:3000](http://localhost:3000)

---

### ä¸¤ç«¯ä¸€èµ·è·‘

å®‰è£… concurrentlyï¼š

```bash
npm install -D concurrently
```

æ ¹ç›®å½• `package.json` æ·»åŠ ï¼š

```json
"scripts": {
  "dev:client": "cd client && npm run dev",
  "dev:server": "cd server && npm run dev",
  "start": "concurrently \"npm:dev:server\" \"npm:dev:client\""
}
```

ç„¶åè¿è¡Œï¼š

```bash
npm run start
```


## é¡¹ç›®ç›®å½•è¯´æ˜

```
/
â”œâ”€â”€ client/       # å‰ç«¯ React + Vite
â”œâ”€â”€ server/       # åç«¯ Express + Socket.io
â”œâ”€â”€ README.md
```